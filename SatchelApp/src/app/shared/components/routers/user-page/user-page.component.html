<app-header></app-header>
<div class="container">
    <form class="dataSection" [formGroup]="userInfoForm">

        <h2 class="heading">Учётные данные</h2>
        <div class="mainData">
            <div class="dataGroup">
                <p class="blockName">ФИО:</p>
                <ul class="fullNameList">
                    <li class="fullNameList-item">
                        <input class="fullnameInput personalAreaInput" placeholder="Имя" formControlName="firstName" type="text" [(ngModel)]="userData.firstName">
                    </li>
                    <li class="fullNameList-item">
                        <input class="fullnameInput personalAreaInput" placeholder="Фамилия" formControlName="middleName" type="text" [(ngModel)]="userData.middleName">
                    </li>
                    <li class="fullNameList-item">
                        <input class="fullnameInput personalAreaInput" placeholder="Отчество" formControlName="lastName" type="text" [(ngModel)]="userData.lastName">
                    </li>
                </ul>
            </div>

            <div class="dataGroup secondaryDataGroup">
                <div class="secondaryData">
                    <p class="blockName">Почта:</p>
                    <input class="secondaryInfoInput personalAreaInput" placeholder="Почта" formControlName="email" type="text " [(ngModel)]="userData.email">
                </div>

                <div class="secondaryData">
                    <p class="blockName">Дата рождения:</p>
                    <input class="secondaryInfoInput personalAreaInput" placeholder="Дата Рождения" formControlName="birth" type="date" [(ngModel)]="userData.dateOfBirth">
                </div>
            </div>

            <!-- <section class="payDataSection">
                <h2 class="heading">Оплата</h2>
                <div class="payData">
                    <p class="blockName">Cпособ оплаты:</p>
                     <select name="PayMethod" class="personalAreaSelect" name="paySelection" [(ngModel)]="userData"> 
                        <option *ngFor="let paymentType of paymentTypes" [value]="paymentType.paymentTypeId">
                            {{paymentType.name}}
                          </option>
                    </select>
                </div>
            </section> -->
        
            <!-- <section class="feedbackDataSection">
                <h2 class="heading">Отзывы</h2>
                <div>
                    <div class="">Мои отзывы:</div>
                </div>
            </section> -->

            <div class="button-group">
                <button (click)="updateUserInfo()" class="btn save-btn">Сохранить</button>
                <button *ngIf="this.userData.userType == 'Продавец'" (click)="openCreateWindow()" class="btn create-btn">Добавить товар</button>
                <button (click)="exitFromAccount()" class="btn delete-btn">Выйти</button>
            </div>
        </div>

    </form>

    <img  class="user-avatar" formControlName="userPhoto" (click)="fileInput.click()" [src]="userData.userPhotoSrc" alt="Ваша фотография">          
    <input #fileInput type="file" style="display: none" (change)="onFileSelected($event)">  

</div>

<div *ngIf="this.userData.userType == 'Продавец' && sellerProducts.length > 0" class="secondaryContainer">
    <h2 class="products__title">Мои Товары:</h2>

    <ul class="products__container">
        <li class="product__item" *ngFor="let product of sellerProducts">
            <div class="product-item__image">
                <app-carousel [images]="product.images"></app-carousel>
            </div>
    
            <div class="product-item__description" (click)="goToProduct(product.productId)">
                <h2 class="product-item__name">{{product.name}}</h2>
                <p class="product-item__price">{{getFormattedPrice(product.price)}}</p>
            </div>
    
            <img class="product-item__trash" (click)="deleteSellerProduct(product.productId)" src="../../../../../assets/images/icons/trash.svg" alt="">
        </li>
    </ul>
    
    <button *ngIf="sellerProducts.length >= 3" (click)="showMoreProducts()" class="moreBtn">Ещё</button>
</div>

<div *ngIf="orders.length > 0" class="secondaryContainer">
    <h2 class="products__title">Мои заказы:</h2>

    <ul class="orders__list">
        <li *ngFor="let order of orders" class="orders__list__item">
            <div class="order-image">
                <app-carousel [images]="order.productCartDto.images"></app-carousel>
            </div>

            <div class="order-info">
                <h3 class="order__text title">{{order.productCartDto.name}}</h3>

                <p class="order__text">{{order.productCartDto.price}}</p>
            </div>

            <div class="order__shipping-info">
                <div class="shipping-info">
                    <div>Статус заказа:</div>
                    <div>{{order.orderStatusTypeName}}</div>
                </div>
                <div class="shipping-info">
                    <div>Дата поступления:</div>
                    <div>{{order.deliveryDate}}</div>
                </div>
                <div class="shipping-info">
                    <div>Код выдачи:</div>
                    <div>{{order.receiptCode}}</div>
                </div>
            </div>  
        </li>
    </ul>

</div>

<div *ngIf="statusMsg" class="statusMessage">{{statusMsg}}</div>

<app-footer></app-footer>

<app-create-window *ngIf="isCreateProductWindowOpen"></app-create-window>